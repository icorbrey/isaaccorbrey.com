---
import { noteStore } from "../../features/notes/store";
import Note from "../../layouts/Note.astro";

const slug = Astro.params.slug!;
const note = await noteStore.getSingle({
    includeDrafts: import.meta.env.DEV,
    slug,
});

if (!note) {
    return Astro.rewrite("/404");
}

const { Content, remarkPluginFrontmatter } = await note.render();
const frontmatter = {
    ...note?.data,
    ...remarkPluginFrontmatter,
};
---

<Note {slug} {frontmatter}>
    <Content />
</Note>
