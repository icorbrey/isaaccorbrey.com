---
import { articleSchema } from "../utils/openGraph";
import Layout from "../controls/Layout.svelte";
import { z } from "astro:content";
import "../style/global.css";

const layoutProps = z.object({
	image: z.string().default("https://isaaccorbrey.com/profile.png"),
	properties: articleSchema.default({}),
	type: z.string().default("website"),
	title: z.string(),
	path: z
		.string()
		.transform((p) => `https://isaaccorbrey.com${p}`)
		.default(""),
	description: z
		.string()
		.transform((d) => d.trim())
		.optional(),
});

type Props = z.input<typeof layoutProps>;
const props = layoutProps.parse(Astro.props);

const siteName = "Isaac Corbrey";
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Astro description" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Afacad+Flux:wght@100..1000&display=swap"
			rel="stylesheet"
		/>
		<meta name="generator" content={Astro.generator} />

		<title>{[props.title, siteName].filter(Boolean).join(" - ")}</title>

		<meta property="og:url" content={props.path} />
		<meta property="og:site_name" content={siteName} />
		<meta property="og:title" content={props.title} />
		{
			props.description && (
				<meta property="og:description" content={props.description} />
			)
		}
		<meta property="og:image" content={props.image} />
		<meta property="og:type" content={props.type} />
		{
			Object.entries(props.properties).map(([key, content]) =>
				[]
					.concat(content as any)
					.filter(Boolean)
					.map((content) => (
						<meta property={`og:${key}`} {content} />
					)),
			)
		}
	</head>
	<body>
		<Layout>
			<slot />
		</Layout>
	</body>
</html>
